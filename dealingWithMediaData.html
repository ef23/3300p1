<html>
<head>
<title></title>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="https://d3js.org/topojson.v2.min.js"></script>
<link href="https://fonts.googleapis.com/css?family=Share+Tech+Mono" rel="stylesheet">
</head>

<body>
<script>

var midnight = new Date();
midnight.setHours(0, 0, 0, 0);
midnight = midnight.getTime();
var dayInMill = 86400000;

function getTime(date){ //created_at
   return midnight +
          (date.getHours() * 60 * 60 * 1000) +
          (date.getMinutes() * 60 * 1000) +
          (date.getSeconds() * 1000);
}
var outlets = {"cnn": 0, "nbc":0, "washington post" : 0, "nytimes" : 0, "fox" :0 , "breitbart": 0}

var rawData;
d3.json("testMediaData.json", callback);

var cnnCount = 0;
var nbcCount = 0;
var wapoCount = 0;
var nytCount = 0;
var foxCount = 0;
var breitCount = 0;
var miscCount = 0;

var fakeNews = 0;
var notFake = 0;



function callback(data) {
  rawData = data;
	 
  rawData.forEach(function(d, i) {
    var date = d.created_at; // fix date format 
    d.created_at = new Date(date);
		
		d.outlet = [];
		var outlet = d.outlet;
		
		// outlet
		var tweet = d.text.toLowerCase();
		var news_outlet;
		if (tweet.includes("cnn")) { // CNN
			cnnCount++;
			outlet.push("cnn");
		}
		if (tweet.includes("nbc") || tweet.includes("msnbc")) { //NBC
			nbcCount++;
			outlet.push("nbc");
		}
		if (tweet.includes("washington post") || tweet.includes("washingtonpost") || tweet.includes("wapo")) { // WASHINGTON POST
			wapoCount++;
			outlet.push("washingtonpost");
		}
		if (tweet.includes("nytimes") || tweet.includes("new york times")) { // NYTIMES
			nytCount++;
			outlet.push("nyt");
		}
		if (tweet.includes("fox")) { // FOX
			foxCount++;
			outlet.push("fox");
		}
		if (tweet.includes("breitbart")) { // BREITBART
			breitCount++;
			outlet.push("breitbart");
		}
		
		if (outlet.length == 0) {
			miscCount++;
			outlet.push("misc");
		}
		
		d.is_fakeNews = false;
		
		// fake news or just news
		if (tweet.includes("fake") || tweet.includes("dishonest") || tweet.includes("fake")) { // CNN
			fakeNews++;
			d.is_fakeNews = true;
		} else {
			notFake++;
		}
		
		// label by month
		var m = d.created_at.getMonth();
		d.month = m;
})
}
</script>
</body>
</html>